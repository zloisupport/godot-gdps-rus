# Space Rocks: Build a 2D Arcade Classic with Physics

В этой главе вы освоили основы Godot Engine, создав небольшую 2D-игру. Вы настроили проект, создали несколько сцен, работали со спрайтами и анимациями, обработали ввод пользователя, использовали сигналы для общения между узлами и создали пользовательский интерфейс. Все эти навыки являются важными для работы в любом проекте на Godot.

Перед переходом к следующей главе пройдитесь по проекту. Знаете ли вы, что делает каждый узел? Есть ли куски кода, которые вы не понимаете? Если таковы, вернитесь и пересмотрите соответствующий раздел главы.

Также не стесняйтесь экспериментировать с игрой и изменять её. Одним из лучших способов понять, как работают различные части игры, является их изменение и наблюдение за результатами.

Помните совет из главы 1? Если вы действительно хотите быстро развивать свои навыки, закройте эту книгу, создайте новый проект в Godot и попробуйте создать Coin Dash снова, не подсматривая. Если вам придется посмотреть в книгу, это нормально, но старайтесь заглядывать только после того, как попробуете сами разобраться.

В следующей главе вы изучите более сложные возможности Godot и узнаете, как использовать различные типы узлов, создав более сложную игру.


![HUD](/img/2-space/1.png)

Вы узнаете о следующих ключевых темах в этом проекте:
::list 
  - Использование пользовательских входных действий
  - Физика с использованием RigidBody2D
  - Организация игровой логики с помощью конечных автоматов
  - Создание динамичного, масштабируемого пользовательского интерфейса (UI)
  - Звук и музыка
  - Эффекты частиц
::

## Технические требования

Загрузите игровые ресурсы по следующей ссылке ниже и разархивируйте их в новую папку проекта:


[**GitHub**](https://github.com/PacktPublishing/Godot-4-Game-Development-Projects-Second-Edition/tree/main/Downloads)

Вы также можете найти полный код этой главы на GitHub по адресу:
You can also find the complete code for this chapter on GitHub at:


[**GitHub**](https://github.com/PacktPublishing/Godot-4-Game-Development-Projects-Second-Edition/tree/main/Chapter03%20-%20Space%20Rocks)


Создайте новый проект и загрузите ресурсы проекта по следующему URL. [**GitHub**](https://github.com/PacktPublishing/Godot-4-Game-Development-Projects-Second-Edition/tree/main/Downloads)

Для этого проекта вы настроите пользовательские действия ввода в Input Map. Используя эту функцию, вы можете определить пользовательские входные события и назначить им разные клавиши, события мыши или другие вводы. Это обеспечивает большую гибкость в проектировании вашей игры, так как ваш код может быть написан так, чтобы реагировать на ввод "прыжок", например, не зная точно, какую клавишу и/или кнопку пользователь нажал, чтобы это событие произошло. Это позволяет сделать одинаковый код, работающий на разных устройствах, даже если они имеют разные аппаратные характеристики. Кроме того, поскольку многие геймеры ожидают возможности настроить ввод в игре, это также позволяет предоставить эту опцию пользователю.

Чтобы настроить вводы для этой игры, откройте Project | Project Settings и выберите вкладку Input Map.

Вам нужно создать четыре новых действия ввода: rotate_left, rotate_right, thrust и shoot. Введите название каждого действия в поле "Add New Action" и нажмите Enter или кнопку Add. Убедитесь, что вы вводите имена точно так, как показано, поскольку они будут использоваться в коде позже.

Затем для каждого действия нажмите кнопку + справа от него. Во всплывающем окне вы можете вручную выбрать конкретный тип ввода, или вы можете нажать физическую кнопку, и Godot ее обнаружит. Вы можете добавить несколько вводов к каждому действию. Например, чтобы позволить игрокам использовать как стрелочные клавиши, так и клавиши WASD, настройка будет выглядеть следующим образом:

![HUD](/img/2-space/2.png)

Если у вас подключен геймпад или другой контроллер к вашему компьютеру, вы также можете добавить его входы к действиям тем же способом.
Примечание: 
На данном этапе мы рассматриваем только входы в стиле кнопок, поэтому, хотя вы сможете использовать D-pad для этого проекта, использование аналогового джойстика потребует изменений в коде проекта.


## Физика твердого тела

В разработке игр часто необходимо знать, когда два объекта в игровом пространстве пересекаются или вступают в контакт. Это известно как обнаружение столкновений. Когда столкновение обнаружено, обычно вы хотите, чтобы что-то произошло. Это называется обработка столкновений.

Godot предлагает три вида физических тел, сгруппированных под типом узла PhysicsBody2D:
::list
  -  StaticBody2D: Статическое тело – это тело, которое не перемещается физическим движком. Он участвует в обнаружении столкновений, но не перемещается в ответ. Этот тип тела чаще всего используется для объектов, являющихся частью окружения или не требующих динамического поведения, таких как стены или земля.

  -  RigidBody2D: Это тело физики, которое обеспечивает имитацию физики. Это означает, что вы не управляете положением тела физики RigidBody2D напрямую. Вместо этого вы применяете к нему силы (гравитацию, импульсы и так далее), а встроенный физический движок Godot вычисляет результативное движение, включая столкновения, отскок, вращение и другие эффекты.

  -  CharacterBody2D: Этот тип тела предоставляет обнаружение столкновений, но не имеет физики. Весь движение должно быть реализовано в коде, и ответ на столкновение также требуется реализовать самостоятельно. Кинематические тела чаще всего используются для игровых персонажей или других объектов, требующих аркадной физики, а не реалистичного моделирования, или когда требуется более точное управление тем, как двигается тело.
::


Понимание, когда использовать определенный тип физического тела, является важной частью создания вашей игры. Использование правильного типа может упростить разработку, в то время как попытка заставить неподходящий узел выполнять эту задачу может привести к разочарованию и плохим результатам. Работая с каждым типом тела, вы узнаете их преимущества и недостатки, и поймете, когда они могут быть полезны для создания нужного вам функционала.

В этом проекте вы будете использовать узел RigidBody2D для корабля и самих камней. Вы также узнаете о других типах тел в последующих главах.

У индивидуальных узлов RigidBody2D есть множество свойств, которые можно использовать для настройки их поведения, таких как Масса, Трение или Отскок. Эти свойства можно установить в инспекторе.

Rigid bodies также подвержены воздействию глобальных свойств, которые можно установить в настройках проекта( Project Settings) в разделе Физика|2D( Physics | 2D). Эти настройки применяются ко всем телам в мире.

![HUD](/img/2-space/3.png)

В большинстве случаев вам не потребуется изменять эти настройки. Однако обратите внимание, что по умолчанию гравитация имеет значение 980 и направлена вниз (0, 1). Если вы хотите изменить гравитацию мира, вы можете сделать это здесь.
Если вы щелкнете переключатель Расширенные настройки в верхнем правом углу окна Настроек проекта, вы увидите много продвинутых значений конфигурации для физического движка. Вам следует обратить внимание на два из них: Default Linear Damp и Default Angular Damp. Эти свойства контролируют, насколько быстро тело теряет скорость движения вперед и скорость вращения соответственно. Установка их на более низкие значения создаст ощущение отсутствия трения, в то время как более высокие значения будут создавать впечатление, что ваши объекты двигаются через густую жидкость. Это может быть отличным способом применения различных стилей движения для различных игровых объектов и сред.

Переопределение физики области
Узлы Area2D также могут влиять на физику тел с жесткими связями, используя свойство Space Override. Пользовательские значения гравитации и затухания затем будут применяться ко всем телам, которые входят в область.
Поскольку игра будет происходить в открытом космосе, гравитация не понадобится, поэтому установите Default Gravity на 0. Остальные настройки можно оставить без изменений.
Это завершает задачи настройки проекта. Это хорошая идея просмотреть этот раздел и убедиться, что вы ничего не упустили, поскольку внесенные здесь изменения повлияют на поведение многих игровых объектов. Вы увидите это в следующем разделе, где вы создадите космический корабль игрока.
